(()=>{var t={44:(t,e,n)=>{const{MarkovChainBase:s}=n(290),{MarkovChainText:o}=n(424),{MarkovChainTextTool:r}=n(707);t.exports={MarkovChainBase:s,MarkovChainText:o,MarkovChainTextTool:r}},290:t=>{const e="markov-chain-base";t.exports={MarkovChainBase:class{constructor(t=2,e=null){e=e||{},this.n=Math.max(1,t||2),this.transitions=new Map,e.transitions&&this.setTransitions(e.transitions),this.persistence=e.persistence}train(t){for(let e=0;e<t.length-this.n+1;++e){const n=t.slice(e,e+this.n-1).join(" "),s=t[e+this.n-1];this.transitions.has(n)||this.transitions.set(n,new Map);const o=this.transitions.get(n);o.set(s,(o.get(s)||0)+1)}return this}setTransitions(t){for(const[e,n]of Object.entries(t))this.transitions.set(e,new Map(n));return this}generate(t,e=1){if(t.length<this.n-1)throw new Error(`need ${this.n-1} or more states, but got ${t.length}`);const n=(t,e)=>e>0?t.slice(-e):[];let s=n(t,this.n-1);const o=[...t],r="number"==typeof e?(t,n)=>n<e:e;for(let t=0;r(o,t);++t){const t=s.join(" "),e=this.transitions.get(t);if(!e||!e.size)break;let r=0;for(const t of e.values())r+=t;let i=0;const a=Math.random();for(const[t,h]of e)if(i+=h/r,a<=i){o.push(t),s=n([...s,t],this.n-1);break}}return o}toJson(){const t={type:e,n:this.n,transitions:{}};for(const[e,n]of this.transitions)t.transitions[e]=Array.from(n.entries());return t}fromJson(t){return t&&t.type===e?(this.n=t.n||this.n,this.setTransitions(t.transitions)):this}async save(){if(!this.persistence)throw new Error("persistor not defined");await this.persistence.save(this)}async load(){if(!this.persistence)throw new Error("persistor not defined");await this.persistence.load(this)}},NGRAM_ORDER_DEFAULT:2}},424:(t,e,n)=>{const{MarkovChainBase:s,NGRAM_ORDER_DEFAULT:o}=n(290),{MarkovChainTextTool:r}=n(707);t.exports={MarkovChainText:class extends s{constructor(t=o,e=null){super(t,e),e=e||{},this.textTool=new r(e.textTool)}train(t){const e=this.textTool.tokenize(t);return super.train(e)}generate(t,e=1){const n=this.textTool.tokenize(t),s=super.generate(n,e);return this.textTool.join(s)}generateSentence(t,e=1){return this.generate(t,(t=>this.textTool.countSentences(t)<e))}}}},707:t=>{t.exports={MarkovChainTextTool:class{constructor(t){this.tool=t,this.sep=/(?:\s|\r?\n)+/g}tokenize(t){if(Array.isArray(t))return t.map((t=>this.tokenize(t))).flat();const e=this.tool;if(e&&"function"==typeof e.tokenize)return e.tokenize(t);const n=(Array.isArray(t)?t:[t]).map((t=>t.split(this.sep))).flat();return n}join(t){if(!Array.isArray(t))return t;const e=this.tool;return e&&"function"==typeof e.join?e.join(t):t.join(" ")}countSentences(t){t=this.tokenize(t);const e=this.tool;return e&&"function"==typeof e.countSentences?e.countSentences(t):t.filter((t=>t.endsWith("."))).length}}}}},e={},n=function n(s){var o=e[s];if(void 0!==o)return o.exports;var r=e[s]={exports:{}};return t[s](r,r.exports,n),r.exports}(44),s=window;for(var o in n)s[o]=n[o];n.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();